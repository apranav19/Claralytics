{% extends "base_template.html" %} 
{% block content %}
 <script type="text/javascript">     
      google.load("visualization", "1", {packages:["corechart"]});
      google.setOnLoadCallback(drawChart);

      function drawChart() {

      	var device_items = []

      	var device_data = $('#load_device_data').data('device');

      	$.each(device_data, function(key, value){
      		device_items.push([key, value]);
      	});
        
        var options = {
	 		is3D: true,
	        colors: ['#E5D843','#80BF34','#38A660'],
	        title: 'Visitors by Device Type',
	        'legend': 'right',
	        animation:{
       			duration: 8000,
        		easing: 'in'
      		},
	        pieSliceText: 'percentage',
	 	  	slices: {
	                  1: {offset: 0.2},
	                  2: {offset: 0.1},
	                  3: {offset: 0.0},
	                  pieSliceTextStyle:{fontSize:'20'},
	                  'pieStartAngle':'160'
	        },
	    };

      	var pie_data = new google.visualization.DataTable();
      	pie_data.addColumn('string', 'Device Type');
      	pie_data.addColumn('number', 'Number of Visitors');
      	pie_data.addRows(device_items);

      	var row = 0;
      	var col = 0;

      	var chart = new google.visualization.PieChart(document.getElementById('pie'));
    	chart.draw(pie_data, options);

      }
 </script>

 <!-- script for bargraph -->
 <script>
	  google.load("visualization", "1", {packages:["corechart"]});
      google.setOnLoadCallback(drawChart);
 	  function drawChart() {
          // Create and populate the data table.
        var option = {title:"Hits for The Santa Clara in this month (shown per week)",
                     width:500, height:200,
                     animation: {duration: 2000, easing: 'in',},
                     vAxis: {title: "",titleTextStyle: {color: 'red'}},
                     'legend':'none',
                     hAxis: {title: "Hits on each week", minValue:0, maxValue:800,titleTextStyle: {color: 'red'},
           gridlines:{color:'transparent'}},
                      series: {
        0: {
                    // set the color to change to
                    color: '009EBF',
                    // don't show this in the legend
                    visibleInLegend: false,       
          
                },
                1: {
                    // set the color to change to
                    color: 'FFA500',
                    // don't show this in the legend
                    visibleInLegend: false,      
                }
      }
        
     };
		var monthly_hits = $('#load_monthly_hits').data('mhits');

        var data = new google.visualization.DataTable();    
        data.addColumn('string', 'Week');
        data.addColumn('number', 'Hits');
        $.each(monthly_hits, function(key, value){
        	data.addRow(['Week' + key, 0]);
        });

        // Create and draw the visualization.

        var chart = new google.visualization.BarChart(document.getElementById('panel-304865'));
        chart.draw(data, option);
        var row_index = 0;
        $.each(monthly_hits, function(key, value){
        	data.setValue(row_index, 1, value);
        	row_index++;
        });
        chart.draw(data, option);
      }

 </script>

<!--script for line graph -->
<script>
 	  google.load("visualization", "1", {packages:["corechart"]});
      google.setOnLoadCallback(drawChart);

      function drawChart() {

      	var weekly_stats = []
		var weekly_hits = $('#load_weekly_hits').data('whits');

      	$.each(weekly_hits, function(key, value){  		
      		weekly_stats.push([key, 0]);
      	});

		var data = new google.visualization.DataTable();
        data.addColumn('string', 'Date');
    	data.addColumn('number', 'Number of Visitors');
    	data.addRows(weekly_stats);

        var options = {
          title: 'Visitors per day',
		  'legend':'none',
		  colors:['#004411'],
		  animation: {duration: 1000, easing: 'out'},
		  hAxis:
		  {
			 format:'E,d',
			 title:'Days in a week',
			 gridlines:{ color: 'red'},
			 slantedText:true,
			 slantedTextAngle:30,
			 textStyle:{bold:true},
			 titleTextStyle: {color: 'red'}
		  },
		  vAxis:
		  {
			 title:'Number of Hits'	 ,
			 minValue:0, maxValue:100,
			 gridlines:{count:5, color:'transparent'},
			 textStyle:{bold:true},
			 titleTextStyle: {color: 'red'}
		  },
		  pointSize:4
        };

        var chart = new google.visualization.LineChart(document.getElementById('panel-465099'));
		chart.draw(data, options);
		var row_index = 0;
      	$.each(weekly_hits, function(key, value){  		
      		data.setValue(row_index, 1, value);
      		row_index++;
      	});
      	chart.draw(data, options);
	}
</script>

<div class="container">
	<div class="row clearfix">
		<div class="col-md-12 column">
			<h1 class="text-center text-primary" style = "font-family:Gauntlet">
				Clara-Lytics
			</h1>
		</div>
	</div>
	<div class="row clearfix">
		<div class="col-md-6 column">
			<div class="panel panel-primary">
				<div class="panel-heading">
					<h3 class="panel-title">
						<span class="glyphicon glyphicon-stats"></span>  Number of Hits
					</h3>
				</div>
				<div class="tabbable" id="tabs-263782">
				<ul class="nav nav-tabs">
					<li class="active actTab">
						<a href="#panel-465099" data-toggle="tab">Weekly</a>
					</li>
					<li>
						<a href="#panel-304865" data-toggle="tab">Monthly</a>
					</li>
				</ul>
				<div class="tab-content graphs">
					<div id="load_weekly_hits" data-whits="{{controller.fetch_weekly_visits()}}" style="display:none"></div>	
					<div class="tab-pane active weekly_hits" id="panel-465099" style="width: 500px; height: 200px;">
						<p>
							hits for a week
						</p>
					</div>
					<div id="load_monthly_hits" data-mhits="{{controller.fetch_monthly_visits()}}" style="display:none"></div>	
					<div class="tab-pane" id="panel-304865" style="width: 500px; height: 200px;">
						<p>
							hits for a month
						</p>
					</div>
				</div>
			</div>
			<div class="row clearfix">
				<div class="col-md-4 column">
				</div>
				<div class="col-md-4 column">
					 <button type="button" class="btn btn-sm ">
					 	<span class="glyphicon glyphicon-chevron-left"></span>Prev</button>
				</div>
				
				<div class="col-md-4 column">
					 <button type="button" class="btn btn-sm nextbtn">Next<span class="glyphicon glyphicon-chevron-right"></span></button>
				</div>
			</div>  
			</div>
		</div>
		<div class="col-md-6 column">
			<div class="panel panel-primary">
				<div class="panel-heading">
					<h3 class="panel-title">
						<span class="glyphicon glyphicon-eye-open"></span> Most Popular Articles and Categories
					</h3>
				</div>
				<div class="col-md-12 column">
			<table class="table table-hover table-striped">
				<thead>
					<tr>
						<th>
							#
						</th>
						<th>
							Article
						</th>
						<th>
							Category
						</th>
					</tr>
				</thead>
				<tbody>
					<tr>
						<td>
							1
						</td>
						<td>
							TB - Monthly
						</td>
						<td>
							01/04/2012
						</td>
						
					</tr>
					<tr class="active">
						<td>
							1
						</td>
						<td>
							TB - Monthly
						</td>
						<td>
							01/04/2012
						</td>
						
					</tr>
					<tr class="success">
						<td>
							2
						</td>
						<td>
							TB - Monthly
						</td>
						<td>
							02/04/2012
						</td>
						
					</tr>
					<tr class="warning">
						<td>
							3
						</td>
						<td>
							TB - Monthly
						</td>
						<td>
							03/04/2012
						</td>
						
					</tr>
					<tr class="danger">
						<td>
							4
						</td>
						<td>
							TB - Monthly
						</td>
						<td>
							04/04/2012
						</td>
						
					</tr>
				</tbody>
			</table>
		</div>				
		</div>
		</div>
	</div>
	<div class="row clearfix">
		<div class="col-md-8 column">
			<div class="panel panel-info">
				<div class="panel-heading">
					<h3 class="panel-title">
						<span class="glyphicon glyphicon-google-maps"></span>Geographic User Base
					</h3>
				</div>
				<div class="panel-body">
					Panel content
				</div>
				<div class="panel-footer">
					Panel footer
				</div>
			</div>
		</div>
		<div class="col-md-4 column">
			<div class="panel panel-primary">
				<div class="panel-heading">
					<h3 class="panel-title">
						<span class="glyphicon glyphicon-pie-chart"></span> Device Type
					</h3>
				</div>
				<div id="load_device_data" data-device="{{controller.fetch_device_type()}}" style="display:none"></div>	
				<div class="row clearfix">
					<div class="col-md-12">
						<div id = "pie">	
						</div>
					</div>
				</div>
				
			</div>
		</div>
	</div>
	<div class="container">
	<div class="row clearfix">
		<div class="col-md-12 lastRow">
			<div class="row">
				<div class="col-md-4">
					<div class="thumbnail">
						<img alt="300x200" src="{{ url_for('static', filename='FB-f-Logo__blue_72.png') }}" />
						<div class="caption">
							<h3 class="text-center text-primary">
								60
							</h3>
							
						</div>
					</div>
				</div>
				<div class="col-md-4">
					<div class="thumbnail">
						<img alt="300x200" class="img-rounded" src="{{ url_for('static', filename='Twitter_logo_blue.png') }}" />
						<div class="caption">
							<h3 class="text-center text-primary">
								25
							</h3>					
						</div>
					</div>
				</div>
				<div class="col-md-4">
					<div class="thumbnail">
						<img alt="300x200" src="{{ url_for('static', filename='gplus-128[1].png') }}" />
						<div class="caption">
							<h3 class="text-center text-primary">
								30
							</h3>
						
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
	</div>
</div>
{% endblock %}
